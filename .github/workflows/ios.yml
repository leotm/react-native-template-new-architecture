name: iOS CI with Xcode

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build-ios:

    runs-on: macos-26 # https://github.com/actions/runner-images/blob/main/images/macos/macos-26-arm64-Readme.md

    steps:

    - uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6

#     - uses: mikehardy/buildcache-action@v1

#       yarn cache
#       node_modules cache

    - name: Install deps and setup
      run: yarn && yarn setup

    - name: npx react-native info
      run: npx react-native info

#     - uses: ruby/setup-ruby@v1
#       with:
#         bundler-cache: true # bundle install and cache installed gems automatically
#     - run: bundle exec rake

#     - uses: setup/cocoapods # cache
#       DerivedData cache

#     Debug
#     - name: Install pods (debug)
#       run: cd ios && pod update hermes-engine --no-repo-update && cd ..
#     - name: Build iOS (debug)
#       run: npx react-native run-ios --configuration Debug

#     - name: Xcode clean
#       run: xcodebuild clean

#     Release
    - name: Install pods (release)
      run: cd ios && PRODUCTION=1 pod install  && cd .. # --clean-install --repo-update
    - name: Build iOS (release)
      run: npx react-native run-ios --configuration Release
